<div class="container-fluid p-4">
  <div class="flex align-items-center justify-content-between mb-4">
    <h1 class="text-3xl font-bold text-900 m-0">
      <i class="pi pi-cog mr-3"></i>Keresked√©si Be√°ll√≠t√°sok
    </h1>
  </div>

  <p-tabView>
    <!-- Auto Trading Tab -->
    <p-tabPanel header="Auto-Trading" leftIcon="pi pi-cog">
      <p-card header="Automatikus Keresked√©s Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <div class="col-12">
            <div class="field">
              <label class="text-lg font-semibold mb-3 block">Keresked√©si M√≥d</label>
              
              <div class="flex flex-column gap-4">
                <div class="flex align-items-center p-3 border border-gray-200 rounded-lg">
                  <p-radioButton
                    name="tradingMode"
                    value="manual"
                    [(ngModel)]="tradingMode"
                    inputId="manual"
                    (onClick)="onTradingModeChange()">
                  </p-radioButton>
                  <label for="manual" class="ml-3 cursor-pointer flex-1">
                    <div class="font-semibold text-gray-900">üéØ Manu√°lis Keresked√©s</div>
                    <div class="text-sm text-gray-600 mt-1">
                      Minden keresked√©st manu√°lisan kell j√≥v√°hagyni. Teljes kontroll a d√∂nt√©sek felett.
                    </div>
                  </label>
                </div>
                
                <div class="flex align-items-center p-3 border border-gray-200 rounded-lg">
                  <p-radioButton
                    name="tradingMode"
                    value="automatic"
                    [(ngModel)]="tradingMode"
                    inputId="automatic"
                    (onClick)="onTradingModeChange()">
                  </p-radioButton>
                  <label for="automatic" class="ml-3 cursor-pointer flex-1">
                    <div class="font-semibold text-gray-900">ü§ñ Automatikus Keresked√©s</div>
                    <div class="text-sm text-gray-600 mt-1">
                      A rendszer automatikusan v√©grehajtja a keresked√©seket a be√°ll√≠tott param√©terek alapj√°n.
                    </div>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>


          <!-- Auto Trading Status -->
          <div class="col-12">
            <div class="bg-gray-50 border-round p-4">
              <h4 class="text-900 font-semibold mb-3">
                <i class="pi pi-info-circle mr-2"></i>Jelenlegi √Ållapot
              </h4>
              <div class="grid">
                <div class="col-12 md:col-6">
                  <div class="text-center p-3 border-round"
                       [class]="tradingMode === 'automatic' ? 'bg-green-100 border-green-200' : 'bg-orange-100 border-orange-200'">
                    <div class="text-2xl mb-2">
                      {{ tradingMode === 'automatic' ? 'ü§ñ' : 'üéØ' }}
                    </div>
                    <div class="font-bold text-lg"
                         [class]="tradingMode === 'automatic' ? 'text-green-700' : 'text-orange-700'">
                      {{ tradingMode === 'automatic' ? 'AUTOMATIKUS' : 'MANU√ÅLIS' }}
                    </div>
                    <div class="text-sm text-600 mt-1">
                      {{ tradingMode === 'automatic' ? 'Keresked√©s akt√≠v' : 'Manu√°lis j√≥v√°hagy√°s sz√ºks√©ges' }}
                    </div>
                  </div>
                </div>
                <div class="col-12 md:col-6">
                  <div class="space-y-2">
                    <div class="flex justify-between text-sm">
                      <span class="text-600">Monitoring:</span>
                      <span class="font-medium" [class]="tradingMode === 'automatic' ? 'text-green-600' : 'text-gray-600'">
                        {{ tradingMode === 'automatic' ? '5 percenk√©nt' : 'Kikapcsolva' }}
                      </span>
                    </div>
                    <div class="flex justify-between text-sm">
                      <span class="text-600">Szign√°l v√©grehajt√°s:</span>
                      <span class="font-medium" [class]="tradingMode === 'automatic' ? 'text-green-600' : 'text-orange-600'">
                        {{ tradingMode === 'automatic' ? 'Automatikus' : 'Manu√°lis' }}
                      </span>
                    </div>
                    <div class="flex justify-between text-sm">
                      <span class="text-600">Risk management:</span>
                      <span class="font-medium text-blue-600">Mindig akt√≠v</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Auto Trading Warning -->
          <div class="col-12" *ngIf="tradingMode === 'automatic'">
            <div class="bg-red-50 border-left-3 border-red-500 p-3">
              <div class="text-red-900">
                <i class="pi pi-exclamation-triangle mr-2"></i>
                <strong>Figyelmeztet√©s:</strong>
              </div>
              <div class="text-red-800 mt-2 text-sm">
                Az automatikus keresked√©s val√≥s p√©nzzel t√∂rt√©nik az √©les Binance sz√°ml√°don!<br>
                Gy≈ëz≈ëdj meg r√≥la, hogy:
                <ul class="mt-2 ml-4">
                  <li>‚Ä¢ A poz√≠ci√≥ m√©ret √©s kock√°zatkezel√©si be√°ll√≠t√°sok megfelel≈ëek</li>
                  <li>‚Ä¢ A Binance API kulcsok helyesen vannak be√°ll√≠tva</li>
                  <li>‚Ä¢ Rendszeresen ellen≈ërz√∂d a keresked√©si eredm√©nyeket</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingTradingMode"
                (onClick)="saveTradingMode()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- Position Size Tab -->
    <p-tabPanel header="Poz√≠ci√≥ M√©ret" leftIcon="pi pi-dollar">
      <p-card header="Poz√≠ci√≥ M√©ret Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <div class="col-12">
            <div class="field">
              <label class="text-lg font-semibold mb-3 block">Poz√≠ci√≥ M√©ret M√≥dja</label>
              
              <div class="flex flex-column gap-3">
                <div class="flex align-items-center">
                  <p-radioButton
                    name="mode"
                    value="percentage"
                    [(ngModel)]="positionSizeConfig.mode"
                    inputId="percentage"
                    (onClick)="onPositionModeChange()">
                  </p-radioButton>
                  <label for="percentage" class="ml-2 cursor-pointer">
                    <strong>Sz√°zal√©kos</strong> - A portf√≥li√≥ sz√°zal√©ka alapj√°n
                  </label>
                </div>
                
                <div class="flex align-items-center">
                  <p-radioButton
                    name="mode"
                    value="fixed_usd"
                    [(ngModel)]="positionSizeConfig.mode"
                    inputId="fixed_usd"
                    (onClick)="onPositionModeChange()">
                  </p-radioButton>
                  <label for="fixed_usd" class="ml-2 cursor-pointer">
                    <strong>Fix USD √∂sszeg</strong> - Minden keresked√©shez ugyanaz az √∂sszeg
                  </label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Percentage Mode Settings -->
          <div class="col-12" *ngIf="positionSizeConfig.mode === 'percentage'">
            <div class="field">
              <label for="maxPercentage" class="block text-900 font-medium mb-2">
                Maximum Sz√°zal√©k (%)
              </label>
              <p-inputNumber
                id="maxPercentage"
                [(ngModel)]="positionSizeConfig.max_percentage"
                [min]="0.1"
                [max]="10"
                [step]="0.1"
                suffix="%"
                placeholder="pl. 2.5"
                styleClass="w-full">
              </p-inputNumber>
              <small class="text-600">
                Minden keresked√©s maximum ennyi sz√°zal√©kot haszn√°l a teljes portf√≥li√≥b√≥l (0.1% - 10%)
              </small>
            </div>

            <div class="bg-blue-50 border-left-3 border-blue-500 p-3 mt-3" *ngIf="positionSizeConfig.max_percentage && walletBalance">
              <div class="text-blue-900">
                <i class="pi pi-info-circle mr-2"></i>
                <strong>P√©lda sz√°m√≠t√°s:</strong>
              </div>
              <div class="text-blue-800 mt-2">
                Jelenlegi portf√≥li√≥: <strong>${{ walletBalance | number:'1.2-2' }}</strong><br>
                {{ positionSizeConfig.max_percentage }}% = <strong>${{ calculateExampleAmount() | number:'1.2-2' }}</strong> per keresked√©s
              </div>
            </div>
          </div>

          <!-- Fixed USD Mode Settings -->
          <div class="col-12" *ngIf="positionSizeConfig.mode === 'fixed_usd'">
            <div class="field">
              <label for="fixedAmount" class="block text-900 font-medium mb-2">
                Fix USD √ñsszeg
              </label>
              <p-inputNumber
                id="fixedAmount"
                [(ngModel)]="positionSizeConfig.fixed_amount_usd"
                [min]="1"
                [max]="10000"
                [step]="1"
                prefix="$"
                placeholder="pl. 100"
                styleClass="w-full">
              </p-inputNumber>
              <small class="text-600">
                Minden keresked√©s pontosan ezt az √∂sszeget haszn√°lja ($1 - $10,000)
              </small>
            </div>

            <div class="bg-orange-50 border-left-3 border-orange-500 p-3 mt-3" *ngIf="positionSizeConfig.fixed_amount_usd && walletBalance">
              <div class="text-orange-900">
                <i class="pi pi-exclamation-triangle mr-2"></i>
                <strong>Figyelem:</strong>
              </div>
              <div class="text-orange-800 mt-2">
                Fix √∂sszeg: <strong>${{ positionSizeConfig.fixed_amount_usd }}</strong><br>
                Ez a portf√≥li√≥ <strong>{{ (positionSizeConfig.fixed_amount_usd / walletBalance * 100) | number:'1.1-1' }}%-a</strong>
                <span *ngIf="(positionSizeConfig.fixed_amount_usd / walletBalance * 100) > 5" class="text-red-600">
                  <br><i class="pi pi-exclamation-triangle"></i> Magas kock√°zat! (>5%)
                </span>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingPosition"
                (onClick)="savePositionSizeConfig()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- Risk Management Tab -->
    <p-tabPanel header="Kock√°zatkezel√©s" leftIcon="pi pi-shield">
      <p-card header="Kock√°zatkezel√©si Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <!-- Daily Trade Limit -->
          <div class="col-12 md:col-6">
            <div class="field">
              <label for="maxDailyTrades" class="block text-900 font-medium mb-2">
                <i class="pi pi-calendar mr-2"></i>Napi Trade Limit
              </label>
              <p-inputNumber
                id="maxDailyTrades"
                [(ngModel)]="riskConfig.max_daily_trades"
                [min]="1"
                [max]="100"
                [step]="1"
                placeholder="10"
                styleClass="w-full">
              </p-inputNumber>
              <small class="text-600">
                Maximum keresked√©sek sz√°ma naponta (1-100)
              </small>
            </div>
          </div>

          <!-- Daily Loss Limit -->
          <div class="col-12 md:col-6">
            <div class="field">
              <label for="dailyLossLimit" class="block text-900 font-medium mb-2">
                <i class="pi pi-exclamation-triangle mr-2"></i>Napi Vesztes√©g Limit
              </label>
              <p-inputNumber
                id="dailyLossLimit"
                [(ngModel)]="riskConfig.daily_loss_limit"
                [min]="0.1"
                [max]="50"
                [step]="0.1"
                suffix="%"
                placeholder="5.0"
                styleClass="w-full">
              </p-inputNumber>
              <small class="text-600">
                Maximum napi vesztes√©g a portf√≥li√≥ sz√°zal√©k√°ban (0.1%-50%)
              </small>
            </div>

            <div class="bg-red-50 border-left-3 border-red-500 p-3 mt-3" *ngIf="riskConfig.daily_loss_limit && walletBalance">
              <div class="text-red-900">
                <i class="pi pi-exclamation-triangle mr-2"></i>
                <strong>Napi vesztes√©g limit:</strong>
              </div>
              <div class="text-red-800 mt-2">
                {{ riskConfig.daily_loss_limit }}% = <strong>${{ calculateDailyLossAmount() | number:'1.2-2' }}</strong>
                <br><small>Ha el√©red ezt az √∂sszeget, az auto-trading le√°ll</small>
              </div>
            </div>
          </div>

          <!-- Max Position Size -->
          <div class="col-12 md:col-6">
            <div class="field">
              <label for="maxPositionSize" class="block text-900 font-medium mb-2">
                <i class="pi pi-chart-pie mr-2"></i>Maximum Poz√≠ci√≥ M√©ret
              </label>
              <p-inputNumber
                id="maxPositionSize"
                [(ngModel)]="riskConfig.max_position_size"
                [min]="0.1"
                [max]="20"
                [step]="0.1"
                suffix="%"
                placeholder="2.0"
                styleClass="w-full">
              </p-inputNumber>
              <small class="text-600">
                Maximum poz√≠ci√≥ m√©ret a portf√≥li√≥ sz√°zal√©k√°ban (0.1%-20%)
              </small>
            </div>

            <div class="bg-yellow-50 border-left-3 border-yellow-500 p-3 mt-3" *ngIf="riskConfig.max_position_size && walletBalance">
              <div class="text-yellow-900">
                <i class="pi pi-info-circle mr-2"></i>
                <strong>Maximum poz√≠ci√≥:</strong>
              </div>
              <div class="text-yellow-800 mt-2">
                {{ riskConfig.max_position_size }}% = <strong>${{ calculateMaxPositionAmount() | number:'1.2-2' }}</strong> per keresked√©s
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Risk Summary -->
          <div class="col-12">
            <div class="bg-gray-50 border-round p-4">
              <h4 class="text-900 font-semibold mb-3">
                <i class="pi pi-shield mr-2"></i>Kock√°zatkezel√©si √ñsszefoglal√≥
              </h4>
              <div class="grid">
                <div class="col-12 md:col-4">
                  <div class="text-center p-3 border-round bg-white">
                    <div class="text-2xl font-bold text-blue-600">{{ riskConfig.max_daily_trades }}</div>
                    <div class="text-600">Max napi trade</div>
                  </div>
                </div>
                <div class="col-12 md:col-4">
                  <div class="text-center p-3 border-round bg-white">
                    <div class="text-2xl font-bold text-red-600">{{ riskConfig.daily_loss_limit }}%</div>
                    <div class="text-600">Max napi vesztes√©g</div>
                  </div>
                </div>
                <div class="col-12 md:col-4">
                  <div class="text-center p-3 border-round bg-white">
                    <div class="text-2xl font-bold text-orange-600">{{ riskConfig.max_position_size }}%</div>
                    <div class="text-600">Max poz√≠ci√≥ m√©ret</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingRisk"
                (onClick)="saveRiskManagementConfig()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- Trading Environment Tab -->
    <p-tabPanel header="Keresked√©si K√∂rnyezet" leftIcon="pi pi-globe">
      <p-card header="Testnet vs √âles Keresked√©s" styleClass="mb-4">
        <div class="grid">
          <div class="col-12">
            <div class="field">
              <label class="text-lg font-semibold mb-3 block">Keresked√©si K√∂rnyezet</label>
              
              <div class="flex flex-column gap-4">
                <div class="flex align-items-center p-3 border border-gray-200 rounded-lg">
                  <p-radioButton
                    name="environment"
                    [value]="true"
                    [(ngModel)]="useTestnet"
                    inputId="testnet"
                    (onClick)="onEnvironmentChange()">
                  </p-radioButton>
                  <label for="testnet" class="ml-3 cursor-pointer flex-1">
                    <div class="font-semibold text-gray-900">üß™ Testnet (Teszt K√∂rnyezet)</div>
                    <div class="text-sm text-gray-600 mt-1">
                      Fake p√©nzzel t√∂rt√©n≈ë keresked√©s tesztel√©shez. Biztons√°gos, nincs val√≥s p√©nz√ºgyi kock√°zat.
                    </div>
                  </label>
                </div>
                
                <div class="flex align-items-center p-3 border border-gray-200 rounded-lg">
                  <p-radioButton
                    name="environment"
                    [value]="false"
                    [(ngModel)]="useTestnet"
                    inputId="mainnet"
                    (onClick)="onEnvironmentChange()">
                  </p-radioButton>
                  <label for="mainnet" class="ml-3 cursor-pointer flex-1">
                    <div class="font-semibold text-gray-900">üí∞ Mainnet (√âles K√∂rnyezet)</div>
                    <div class="text-sm text-gray-600 mt-1">
                      Val√≥s p√©nzzel t√∂rt√©n≈ë keresked√©s az √©les Binance sz√°ml√°don. Val√≥s p√©nz√ºgyi kock√°zat!
                    </div>
                  </label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Environment Status -->
          <div class="col-12">
            <div class="bg-gray-50 border-round p-4">
              <h4 class="text-900 font-semibold mb-3">
                <i class="pi pi-info-circle mr-2"></i>Jelenlegi K√∂rnyezet
              </h4>
              <div class="grid">
                <div class="col-12 md:col-6">
                  <div class="text-center p-3 border-round"
                       [class]="useTestnet ? 'bg-blue-100 border-blue-200' : 'bg-red-100 border-red-200'">
                    <div class="text-2xl mb-2">
                      {{ useTestnet ? 'üß™' : 'üí∞' }}
                    </div>
                    <div class="font-bold text-lg"
                         [class]="useTestnet ? 'text-blue-700' : 'text-red-700'">
                      {{ useTestnet ? 'TESTNET' : 'MAINNET' }}
                    </div>
                    <div class="text-sm text-600 mt-1">
                      {{ useTestnet ? 'Fake p√©nz - Biztons√°gos teszt' : 'Val√≥s p√©nz - √âles keresked√©s' }}
                    </div>
                  </div>
                </div>
                <div class="col-12 md:col-6">
                  <div class="space-y-2">
                    <div class="flex justify-between text-sm">
                      <span class="text-600">P√©nz t√≠pusa:</span>
                      <span class="font-medium" [class]="useTestnet ? 'text-blue-600' : 'text-red-600'">
                        {{ useTestnet ? 'Fake (teszt)' : 'Val√≥s' }}
                      </span>
                    </div>
                    <div class="flex justify-between text-sm">
                      <span class="text-600">Kock√°zat:</span>
                      <span class="font-medium" [class]="useTestnet ? 'text-green-600' : 'text-red-600'">
                        {{ useTestnet ? 'Nincs' : 'Magas' }}
                      </span>
                    </div>
                    <div class="flex justify-between text-sm">
                      <span class="text-600">API kapcsolat:</span>
                      <span class="font-medium" [class]="currentEnvironment?.api_connected ? 'text-green-600' : 'text-red-600'">
                        {{ currentEnvironment?.api_connected ? 'Kapcsol√≥dva' : 'Nincs kapcsolat' }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Environment Warning -->
          <div class="col-12" *ngIf="!useTestnet">
            <div class="bg-red-50 border-left-3 border-red-500 p-3">
              <div class="text-red-900">
                <i class="pi pi-exclamation-triangle mr-2"></i>
                <strong>FIGYELMEZTET√âS - √âLES KERESKED√âS:</strong>
              </div>
              <div class="text-red-800 mt-2 text-sm">
                Az √©les k√∂rnyezetben val√≥s p√©nzzel kereskedsz!<br>
                Gy≈ëz≈ëdj meg r√≥la, hogy:
                <ul class="mt-2 ml-4">
                  <li>‚Ä¢ A Binance API kulcsok helyesen vannak be√°ll√≠tva</li>
                  <li>‚Ä¢ A poz√≠ci√≥ m√©ret √©s kock√°zatkezel√©si be√°ll√≠t√°sok megfelel≈ëek</li>
                  <li>‚Ä¢ Elegend≈ë egyenleg van a sz√°ml√°n a minimum keresked√©si √©rt√©kekhez</li>
                  <li>‚Ä¢ Rendszeresen ellen≈ërz√∂d a keresked√©si eredm√©nyeket</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Testnet Info -->
          <div class="col-12" *ngIf="useTestnet">
            <div class="bg-blue-50 border-left-3 border-blue-500 p-3">
              <div class="text-blue-900">
                <i class="pi pi-info-circle mr-2"></i>
                <strong>TESTNET M√ìD:</strong>
              </div>
              <div class="text-blue-800 mt-2 text-sm">
                Teszt k√∂rnyezetben vagy, fake p√©nzzel kereskedsz.<br>
                El≈ëny√∂k:
                <ul class="mt-2 ml-4">
                  <li>‚Ä¢ Nincs val√≥s p√©nz√ºgyi kock√°zat</li>
                  <li>‚Ä¢ Tesztelheted a strat√©gi√°kat √©s be√°ll√≠t√°sokat</li>
                  <li>‚Ä¢ Gyakorolhatod a rendszer haszn√°lat√°t</li>
                  <li>‚Ä¢ Unlimited fake egyenleg a tesztel√©shez</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Minimum Requirements Info -->
          <div class="col-12" *ngIf="minimumRequirements">
            <div class="bg-yellow-50 border-left-3 border-yellow-500 p-3">
              <div class="text-yellow-900">
                <i class="pi pi-info-circle mr-2"></i>
                <strong>BINANCE MINIMUM K√ñVETELM√âNYEK:</strong>
              </div>
              <div class="text-yellow-800 mt-2 text-sm">
                <div class="grid">
                  <div class="col-12 md:col-6">
                    <strong>Minimum keresked√©si √©rt√©kek:</strong>
                    <ul class="mt-1 ml-4">
                      <li>‚Ä¢ BTCUSDT, ETHUSDT, BNBUSDT: $10</li>
                      <li>‚Ä¢ ADAUSDT: $5</li>
                      <li>‚Ä¢ SOLUSDT, DOTUSDT: $10</li>
                    </ul>
                  </div>
                  <div class="col-12 md:col-6">
                    <strong>Jelenlegi be√°ll√≠t√°s:</strong>
                    <div class="mt-1">
                      Position size: <strong>${{ minimumRequirements.current_position_size || 'Nincs be√°ll√≠tva' }}</strong><br>
                      Wallet egyenleg: <strong>${{ minimumRequirements.current_wallet_balance | number:'1.2-2' }}</strong>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end gap-2">
              <p-button
                label="Minimum K√∂vetelm√©nyek"
                icon="pi pi-info-circle"
                severity="secondary"
                [loading]="loadingMinimumReqs"
                (onClick)="loadMinimumRequirements()">
              </p-button>
              <p-button
                label="K√∂rnyezet V√°lt√°sa"
                icon="pi pi-refresh"
                [loading]="savingEnvironment"
                (onClick)="saveEnvironmentChange()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- Current Settings Tab -->
    <p-tabPanel header="Jelenlegi Be√°ll√≠t√°sok" leftIcon="pi pi-eye">
      <div class="grid">
        <!-- Current Position Config -->
        <div class="col-12 lg:col-6">
          <p-card header="Poz√≠ci√≥ M√©ret Konfigur√°ci√≥" styleClass="h-full">
            <div *ngIf="currentPositionConfig; else noPositionConfig">
              <div class="flex align-items-center mb-3">
                <i class="pi pi-dollar text-blue-500 mr-2"></i>
                <strong>M√≥d:</strong> 
                <span class="ml-2">{{ currentPositionConfig.mode === 'percentage' ? 'Sz√°zal√©kos' : 'Fix USD' }}</span>
              </div>
              
              <div *ngIf="currentPositionConfig.mode === 'percentage'" class="mb-3">
                <div class="flex align-items-center">
                  <i class="pi pi-percentage text-green-500 mr-2"></i>
                  <strong>Maximum sz√°zal√©k:</strong> 
                  <span class="ml-2">{{ currentPositionConfig.max_percentage }}%</span>
                </div>
              </div>
              
              <div *ngIf="currentPositionConfig.mode === 'fixed_usd'" class="mb-3">
                <div class="flex align-items-center">
                  <i class="pi pi-dollar text-green-500 mr-2"></i>
                  <strong>Fix √∂sszeg:</strong> 
                  <span class="ml-2">${{ currentPositionConfig.fixed_amount_usd }}</span>
                </div>
              </div>
            </div>
            
            <ng-template #noPositionConfig>
              <div class="text-center text-600">
                <i class="pi pi-info-circle text-3xl mb-3"></i>
                <p>Nincs bet√∂lt√∂tt konfigur√°ci√≥</p>
              </div>
            </ng-template>
          </p-card>
        </div>

        <!-- Current Risk Config -->
        <div class="col-12 lg:col-6">
          <p-card header="Kock√°zatkezel√©si Konfigur√°ci√≥" styleClass="h-full">
            <div *ngIf="currentTradingConfig; else noTradingConfig">
              <div class="flex align-items-center mb-3">
                <i class="pi pi-calendar text-blue-500 mr-2"></i>
                <strong>Max napi trade:</strong> 
                <span class="ml-2">{{ currentTradingConfig.max_daily_trades }}</span>
              </div>
              
              <div class="flex align-items-center mb-3">
                <i class="pi pi-exclamation-triangle text-red-500 mr-2"></i>
                <strong>Napi vesztes√©g limit:</strong> 
                <span class="ml-2">{{ (currentTradingConfig.daily_loss_limit * 100) | number:'1.1-1' }}%</span>
              </div>
              
              <div class="flex align-items-center mb-3">
                <i class="pi pi-chart-pie text-orange-500 mr-2"></i>
                <strong>Max poz√≠ci√≥ m√©ret:</strong> 
                <span class="ml-2">{{ (currentTradingConfig.max_position_size * 100) | number:'1.1-1' }}%</span>
              </div>
            </div>
            
            <ng-template #noTradingConfig>
              <div class="text-center text-600">
                <i class="pi pi-info-circle text-3xl mb-3"></i>
                <p>Nincs bet√∂lt√∂tt konfigur√°ci√≥</p>
              </div>
            </ng-template>
          </p-card>
        </div>

        <!-- Wallet Info -->
        <div class="col-12" *ngIf="walletBalance">
          <p-card header="Portf√≥li√≥ Inform√°ci√≥">
            <div class="grid">
              <div class="col-12 md:col-3">
                <div class="text-center p-3 border-round bg-blue-50">
                  <div class="text-2xl font-bold text-blue-600">${{ walletBalance | number:'1.2-2' }}</div>
                  <div class="text-600">Teljes egyenleg</div>
                </div>
              </div>
              <div class="col-12 md:col-3" *ngIf="currentPositionConfig?.mode === 'percentage'">
                <div class="text-center p-3 border-round bg-green-50">
                  <div class="text-2xl font-bold text-green-600">${{ calculateExampleAmount() | number:'1.2-2' }}</div>
                  <div class="text-600">Poz√≠ci√≥ m√©ret</div>
                </div>
              </div>
              <div class="col-12 md:col-3" *ngIf="currentTradingConfig">
                <div class="text-center p-3 border-round bg-red-50">
                  <div class="text-2xl font-bold text-red-600">${{ calculateDailyLossAmount() | number:'1.2-2' }}</div>
                  <div class="text-600">Max napi vesztes√©g</div>
                </div>
              </div>
              <div class="col-12 md:col-3" *ngIf="currentTradingConfig">
                <div class="text-center p-3 border-round bg-orange-50">
                  <div class="text-2xl font-bold text-orange-600">${{ calculateMaxPositionAmount() | number:'1.2-2' }}</div>
                  <div class="text-600">Max poz√≠ci√≥</div>
                </div>
              </div>
            </div>
          </p-card>
        </div>

        <!-- Refresh Button -->
        <div class="col-12">
          <div class="flex justify-content-center">
            <p-button 
              label="Be√°ll√≠t√°sok Friss√≠t√©se" 
              icon="pi pi-refresh" 
              severity="secondary"
              [loading]="loadingPosition || loadingRisk"
              (onClick)="loadAllConfigs()">
            </p-button>
          </div>
        </div>
      </div>
    </p-tabPanel>

    <!-- Technical Indicators Tab -->
    <p-tabPanel header="Technikai Indik√°torok" leftIcon="pi pi-chart-line">
      <p-card header="Technikai Indik√°tor Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <!-- Indicator Weights -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-sliders-h mr-2"></i>Indik√°tor S√∫lyok
            </h4>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="rsiWeight" class="block text-900 font-medium mb-2">RSI S√∫ly</label>
              <p-slider
                id="rsiWeight"
                [(ngModel)]="technicalIndicatorWeights.rsi_weight"
                [min]="0"
                [max]="5"
                [step]="0.1"
                styleClass="w-full">
              </p-slider>
              <small class="text-600">√ârt√©k: {{ technicalIndicatorWeights.rsi_weight }}</small>
            </div>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="macdWeight" class="block text-900 font-medium mb-2">MACD S√∫ly</label>
              <p-slider
                id="macdWeight"
                [(ngModel)]="technicalIndicatorWeights.macd_weight"
                [min]="0"
                [max]="5"
                [step]="0.1"
                styleClass="w-full">
              </p-slider>
              <small class="text-600">√ârt√©k: {{ technicalIndicatorWeights.macd_weight }}</small>
            </div>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="volumeWeight" class="block text-900 font-medium mb-2">Volume S√∫ly</label>
              <p-slider
                id="volumeWeight"
                [(ngModel)]="technicalIndicatorWeights.volume_weight"
                [min]="0"
                [max]="5"
                [step]="0.1"
                styleClass="w-full">
              </p-slider>
              <small class="text-600">√ârt√©k: {{ technicalIndicatorWeights.volume_weight }}</small>
            </div>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="candlestickWeight" class="block text-900 font-medium mb-2">Gyertya Minta S√∫ly</label>
              <p-slider
                id="candlestickWeight"
                [(ngModel)]="technicalIndicatorWeights.candlestick_weight"
                [min]="0"
                [max]="5"
                [step]="0.1"
                styleClass="w-full">
              </p-slider>
              <small class="text-600">√ârt√©k: {{ technicalIndicatorWeights.candlestick_weight }}</small>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- RSI Settings -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-chart-bar mr-2"></i>RSI Be√°ll√≠t√°sok
            </h4>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="rsiPeriod" class="block text-900 font-medium mb-2">Peri√≥dus</label>
              <p-inputNumber
                id="rsiPeriod"
                [(ngModel)]="rsiSettings.period"
                [min]="5"
                [max]="50"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="rsiOverbought" class="block text-900 font-medium mb-2">T√∫lvett Szint</label>
              <p-inputNumber
                id="rsiOverbought"
                [(ngModel)]="rsiSettings.overbought"
                [min]="60"
                [max]="90"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="rsiOversold" class="block text-900 font-medium mb-2">T√∫ladott Szint</label>
              <p-inputNumber
                id="rsiOversold"
                [(ngModel)]="rsiSettings.oversold"
                [min]="10"
                [max]="40"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- MACD Settings -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-chart-line mr-2"></i>MACD Be√°ll√≠t√°sok
            </h4>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="macdFast" class="block text-900 font-medium mb-2">Gyors Peri√≥dus</label>
              <p-inputNumber
                id="macdFast"
                [(ngModel)]="macdSettings.fast_period"
                [min]="5"
                [max]="20"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="macdSlow" class="block text-900 font-medium mb-2">Lass√∫ Peri√≥dus</label>
              <p-inputNumber
                id="macdSlow"
                [(ngModel)]="macdSettings.slow_period"
                [min]="20"
                [max]="50"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="macdSignal" class="block text-900 font-medium mb-2">Signal Peri√≥dus</label>
              <p-inputNumber
                id="macdSignal"
                [(ngModel)]="macdSettings.signal_period"
                [min]="5"
                [max]="15"
                [step]="1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Candlestick Settings -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-chart-bar mr-2"></i>Gyertya Minta Be√°ll√≠t√°sok
            </h4>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="candlestickSensitivity" class="block text-900 font-medium mb-2">√ârz√©kenys√©g</label>
              <p-dropdown
                id="candlestickSensitivity"
                [(ngModel)]="candlestickSettings.sensitivity"
                [options]="sensitivityOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="V√°lassz √©rz√©kenys√©get"
                styleClass="w-full">
              </p-dropdown>
            </div>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="minPatternScore" class="block text-900 font-medium mb-2">Min. Minta Pontsz√°m</label>
              <p-inputNumber
                id="minPatternScore"
                [(ngModel)]="candlestickSettings.min_pattern_score"
                [min]="0.1"
                [max]="1.0"
                [step]="0.1"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingTechnicalSettings"
                (onClick)="saveTechnicalIndicatorSettings()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- AI/ML Tab -->
    <p-tabPanel header="AI/ML Be√°ll√≠t√°sok" leftIcon="pi pi-android">
      <p-card header="Mesters√©ges Intelligencia Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <!-- AI Signal Weight -->
          <div class="col-12 md:col-6">
            <div class="field">
              <label for="aiSignalWeight" class="block text-900 font-medium mb-2">AI Signal S√∫ly</label>
              <p-slider
                id="aiSignalWeight"
                [(ngModel)]="aiMlSettings.ai_signal_weight"
                [min]="0"
                [max]="5"
                [step]="0.1"
                styleClass="w-full">
              </p-slider>
              <small class="text-600">√ârt√©k: {{ aiMlSettings.ai_signal_weight }}</small>
            </div>
          </div>

          <div class="col-12 md:col-6">
            <div class="field">
              <label for="aiConfidenceThreshold" class="block text-900 font-medium mb-2">AI Bizalom K√ºsz√∂b (%)</label>
              <p-inputNumber
                id="aiConfidenceThreshold"
                [(ngModel)]="aiMlSettings.ai_confidence_threshold"
                [min]="30"
                [max]="95"
                [step]="5"
                suffix="%"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- ML Models -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-cog mr-2"></i>ML Modellek
            </h4>
          </div>

          <div class="col-12 md:col-4">
            <div class="field-checkbox">
              <p-checkbox
                id="lstmEnabled"
                [(ngModel)]="aiMlSettings.ml_models.lstm_enabled"
                binary="true">
              </p-checkbox>
              <label for="lstmEnabled" class="ml-2">LSTM Neural Network</label>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field-checkbox">
              <p-checkbox
                id="randomForestEnabled"
                [(ngModel)]="aiMlSettings.ml_models.random_forest_enabled"
                binary="true">
              </p-checkbox>
              <label for="randomForestEnabled" class="ml-2">Random Forest</label>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field-checkbox">
              <p-checkbox
                id="gradientBoostingEnabled"
                [(ngModel)]="aiMlSettings.ml_models.gradient_boosting_enabled"
                binary="true">
              </p-checkbox>
              <label for="gradientBoostingEnabled" class="ml-2">Gradient Boosting</label>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Advanced AI Settings -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-brain mr-2"></i>Halad√≥ AI Be√°ll√≠t√°sok
            </h4>
          </div>

          <div class="col-12 md:col-4">
            <div class="field-checkbox">
              <p-checkbox
                id="marketRegimeDetection"
                [(ngModel)]="aiMlSettings.market_regime_detection"
                binary="true">
              </p-checkbox>
              <label for="marketRegimeDetection" class="ml-2">Piaci Rezsim Felismer√©s</label>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field-checkbox">
              <p-checkbox
                id="sentimentAnalysis"
                [(ngModel)]="aiMlSettings.sentiment_analysis"
                binary="true">
              </p-checkbox>
              <label for="sentimentAnalysis" class="ml-2">Hangulat Elemz√©s</label>
            </div>
          </div>

          <div class="col-12 md:col-4">
            <div class="field">
              <label for="ensembleMethod" class="block text-900 font-medium mb-2">Ensemble M√≥dszer</label>
              <p-dropdown
                id="ensembleMethod"
                [(ngModel)]="aiMlSettings.ensemble_method"
                [options]="ensembleMethodOptions"
                optionLabel="label"
                optionValue="value"
                placeholder="V√°lassz m√≥dszert"
                styleClass="w-full">
              </p-dropdown>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingAIMLSettings"
                (onClick)="saveAIMLSettings()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>

    <!-- Notifications Tab -->
    <p-tabPanel header="√ârtes√≠t√©sek" leftIcon="pi pi-bell">
      <p-card header="√ârtes√≠t√©si Be√°ll√≠t√°sok" styleClass="mb-4">
        <div class="grid">
          <!-- Signal Notifications -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-chart-line mr-2"></i>Signal √ârtes√≠t√©sek
            </h4>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="signalNotificationsEnabled"
                [(ngModel)]="notificationSettings.signal_notifications.enabled"
                binary="true">
              </p-checkbox>
              <label for="signalNotificationsEnabled" class="ml-2">Enged√©lyezve</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="signalEmail"
                [(ngModel)]="notificationSettings.signal_notifications.email"
                binary="true">
              </p-checkbox>
              <label for="signalEmail" class="ml-2">Email</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="signalPush"
                [(ngModel)]="notificationSettings.signal_notifications.push"
                binary="true">
              </p-checkbox>
              <label for="signalPush" class="ml-2">Push</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field">
              <label for="signalMinConfidence" class="block text-900 font-medium mb-2">Min. Bizalom (%)</label>
              <p-inputNumber
                id="signalMinConfidence"
                [(ngModel)]="notificationSettings.signal_notifications.min_confidence"
                [min]="30"
                [max]="95"
                [step]="5"
                suffix="%"
                styleClass="w-full">
              </p-inputNumber>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <!-- Trade Notifications -->
          <div class="col-12">
            <h4 class="text-900 font-semibold mb-3">
              <i class="pi pi-dollar mr-2"></i>Keresked√©si √ârtes√≠t√©sek
            </h4>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="tradeNotificationsEnabled"
                [(ngModel)]="notificationSettings.trade_notifications.enabled"
                binary="true">
              </p-checkbox>
              <label for="tradeNotificationsEnabled" class="ml-2">Enged√©lyezve</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="executionAlerts"
                [(ngModel)]="notificationSettings.trade_notifications.execution_alerts"
                binary="true">
              </p-checkbox>
              <label for="executionAlerts" class="ml-2">V√©grehajt√°si Riaszt√°sok</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="profitLossAlerts"
                [(ngModel)]="notificationSettings.trade_notifications.profit_loss_alerts"
                binary="true">
              </p-checkbox>
              <label for="profitLossAlerts" class="ml-2">Profit/Loss Riaszt√°sok</label>
            </div>
          </div>

          <div class="col-12 md:col-3">
            <div class="field-checkbox">
              <p-checkbox
                id="riskAlerts"
                [(ngModel)]="notificationSettings.trade_notifications.risk_alerts"
                binary="true">
              </p-checkbox>
              <label for="riskAlerts" class="ml-2">Kock√°zati Riaszt√°sok</label>
            </div>
          </div>

          <div class="col-12">
            <p-divider></p-divider>
          </div>

          <div class="col-12">
            <div class="flex justify-content-end">
              <p-button
                label="Ment√©s"
                icon="pi pi-save"
                [loading]="savingNotificationSettings"
                (onClick)="saveNotificationSettings()">
              </p-button>
            </div>
          </div>
        </div>
      </p-card>
    </p-tabPanel>
  </p-tabView>
</div>

<p-toast></p-toast>